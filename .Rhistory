placeholder.test <- word.feature.engineer.binary(mini.subtrain$name,"\\[rm]")
ggplot(mini.subtrain,aes(y = log(price +1), x = factor(placeholder.test)))+
geom_boxplot(fill = c("navy","red"))
placeholder.test <- word.feature.engineer.binary(mini.subtrain$item_description,"\\[rm]")
ggplot(mini.subtrain,aes(y = log(price +1), x = factor(placeholder.test)))+
geom_boxplot(fill = c("navy","red"))
placeholder.test <- word.feature.engineer(mini.subtrain$name,"\\[rm]")
ggplot(mini.subtrain,aes(y = log(price +1), x = factor(placeholder.test)))+
geom_boxplot(fill = c("navy","red"))
placeholder.test <- word.feature.engineer(mini.subtrain$name,"\\[rm]")
ggplot(mini.subtrain,aes(y = log(price +1), x = factor(placeholder.test)))+
geom_boxplot(fill = c("navy","red","lightgreen"))
capital.letter.counter <- function(text.vector){
# Return the occurance of capital letters in the given text vector
capital.letter.count <- sapply(text.vector,function(x){
return(nchar(grep("[A-Z]",x)))})
}
capital.letter.test <- capital.letter.counter(mini.subtrain$item_description)
capital.letter.test[1:5]
text.vector = mini.subtrain$item_description[1]
x = text.vector
grep("[A-Z]",x)
x
grepRaw("[A-Z]",x)
grep("[A-Z]",x, value = T)
str_extract(x,"[A-Z]")
str_extract(x,"*[A-Z]")
str_extract(x,"[*A-Z]")
str_extract_all(x,"[A-Z]")
unlist(str_extract_all(x,"[A-Z]"))
length(unlist(str_extract_all(x,"[A-Z]")))
capital.letter.counter <- function(text.vector){
# Return the occurance of capital letters in the given text vector
capital.letter.count <- sapply(text.vector,function(x){
return(length(unlist(str_extract_all(x,"[A-Z]"))))})
}
capital.letter.test <- capital.letter.counter(mini.subtrain$item_description)
plot(y =log(mini.subtrain$price) x = capital.letter.test,pch = 19, col = "navy", cex = 0.2)
plot(y =log(mini.subtrain$price), x = capital.letter.test,pch = 19, col = "navy", cex = 0.2)
plot(y =log(mini.subtrain$price), x = log(capital.letter.test),pch = 19, col = "navy", cex = 0.2)
capital.letter.test <- capital.letter.counter(mini.subtrain$name)
plot(y =log(mini.subtrain$price), x = log(capital.letter.test),pch = 19, col = "navy", cex = 0.2)
capital.letter.test <- capital.letter.counter(mini.subtrain$brand_name)
plot(y =log(mini.subtrain$price), x = log(capital.letter.test),pch = 19, col = "navy", cex = 0.2)
capital.letter.test <- capital.letter.counter(mini.subtrain$category_name)
plot(y =log(mini.subtrain$price), x = log(capital.letter.test),pch = 19, col = "navy", cex = 0.2)
capital.letter.test <- capital.letter.counter(mini.subtrain$brand_name)
plot(y =log(mini.subtrain$price), x = log(capital.letter.test),pch = 19, col = "navy", cex = 0.2)
# Long operation!
mini.subtrain$cap.letter.brand <- capital.letter.counter(mini.subtrain$brand_name)
subtrain$cap.letter.brand <- capital.letter.counter(subtrain$brand_name)
validation$cap.letter.brand <- capital.letter.counter(valiadtion$brand_name)
validation$cap.letter.brand <- capital.letter.counter(validation$brand_name)
test$cap.letter.brand <- capital.letter.counter(test$brand_name)
#At this point it is necessary to save engineered data sets again for future easy loading:
saveRDS(mini.subtrain,"mini_subtrain.rds")
saveRDS(subtrain,"subtrain.rds")
saveRDS(validation,"validation.rds")
saveRDS(test,"test.rds")
mini.subtrain <-dplyr::select(mini.subtrain, -name, -item_description,-category_name, -brand_name)
subtrain <-dplyr::select(subtrain, -name, -item_description,-category_name, -brand_name)
validation <-dplyr::select(validation, -name, -item_description,-category_name, -brand_name)
test <-dplyr::select(test, -name, -item_description,-category_name, -brand_name)
library(corrplot)
corrplot(cor(mini.subtrain), method = c("shade"), bg = "gray", addgrid.col = "gray")
#At this point it is necessary to save engineered data sets again for future easy loading:
saveRDS(mini.subtrain,"mini_subtrain_locked.rds")
saveRDS(subtrain,"subtrain_locked.rds")
saveRDS(validation,"validation_locked.rds")
saveRDS(test,"test_locked.rds")
# Find the 10 most frequent terms: term_count
term_count <- freq_terms(new_text,4)
library(qdap)
# Print new_text to the console
new_text <- "Text mining usually involves the process of structuring the input text. The overarching goal is, essentially, to turn text into data for analysis, via application of natural language processing (NLP) and analytical methods."
# Find the 10 most frequent terms: term_count
term_count <- freq_terms(new_text,4)
# Plot term_count
plot(term_count)
tweets <- read.csv("https://assets.datacamp.com/production/course_935/datasets/coffee.csv", stringsAsFactors = FALSE)
str(tweets)
View(tweets)
nrow(tweets)
# Isolate text from tweets: coffee_tweets
coffee_tweets <- tweets$text
# Load tm
library(tm)
# Make a vector source: coffee_source
coffee_source <- VectorSource(coffee_tweets)
## coffee_source is already in your workspace
# Make a volatile corpus: coffee_corpus
coffee_corpus <- VCorpus(coffee_source)
# Print out coffee_corpus
coffee_corpus
# Print data on the 15th tweet in coffee_corpus
coffee_corpus[[15]]
# Print the content of the 15th tweet in coffee_corpus
coffee_corpus[[15]][1]
# Create the object: text
text <- "<b>She</b> woke up at       6 A.M. It\'s so early!  She was only 10% awake and began drinking coffee in front of her computer."
# All lowercase
tolower(text)
# Remove punctuation
removePunctuation(text)
# Remove numbers
removeNumbers(text)
# Remove whitespace
stripWhitespace(text)
stemDocument(c("computational", "computers", "computation"))
# Create complicate
complicate <- c("complicated", "complication","complicatedly" )
# Perform word stemming: stem_doc
stem_doc <- stemDocument(complicate)
# Create the completion dictionary: comp_dict
comp_dict <- "complicate"
# Perform stem completion: complete_text
complete_text <- stemCompletion(stem_doc,comp_dict)
# Print complete_text
print(complete_text)
shiny::runApp('Desktop/2016/Data_science/companion')
events.list <- unique(fromJSON(paste0('https://api.fda.gov/drug/event.json?search=receivedate:[',start.date,'+TO+',end.date,']+AND+patient.drug.openfda.brand_name.exact:(%22',drug,'%22)&count=patient.reaction.reactionmeddrapt.exact'))$results$term)
message(        events.list <- unique(fromJSON(paste0('https://api.fda.gov/drug/event.json?search=receivedate:[',start.date,'+TO+',end.date,']+AND+patient.drug.openfda.brand_name.exact:(%22',drug,'%22)&count=patient.reaction.reactionmeddrapt.exact'))$results$term)
)
drug.list
shiny::runApp('Desktop/2016/Data_science/companion')
runApp('Desktop/2016/Data_science/companion')
View(drug.device.data)
runApp('Desktop/2016/Data_science/companion')
runApp('Desktop/2016/Data_science/companion')
runApp('Desktop/2016/Data_science/companion')
!is.null(drug.device.data)
runApp('Desktop/2016/Data_science/companion')
is.null(drug.device.data)
runApp('Desktop/2016/Data_science/companion')
runApp('Desktop/2016/Data_science/companion')
runApp('Desktop/2016/Data_science/companion')
drug = "herceptin"
drug.device.data <- queryDeviceData(drug = drug,
start.date = start.date,
end.date = end.date)
setwd("~/Desktop/2016/Data_science/companion")
drug.device.data <- queryDeviceData(drug = drug,
start.date = start.date,
end.date = end.date)
View(drug.device.data)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
geom_line(colour = "purple", size = 2)+
geom_point(colour = "navy", size = 4)+
labs(x="Date", y = "PRR", title = paste0("Yearly PRR of adverse event ",gsub("\\+"," ",unique(drug.data$event))," for drug ",unique(drug.data$drug)))+
theme(panel.background=element_rect(fill = "white",colour = "black"),
panel.border=element_rect(colour = "black", fill = NA),
plot.title = element_text(hjust = 0.5, face = "bold",size = 15),
axis.title = element_text(size = 13, face = "bold"),
axis.text = element_text(size = 13, face = "bold"))+
geom_text(label = error.text,size = 4.5, color ="red", y = max(drug.data.temp$PRR) - 0.1, x = mean(drug.data$end.year))
runApp()
error.text <- "Currently no data is available for companion Dx associated with this drug through openFDA API\n
Please check again at a later time!"
ggplot(data = drug.data.temp , aes(x = end.year , y = PRR))+
geom_line(colour = "purple", size = 2)+
geom_point(colour = "navy", size = 4)+
labs(x="Date", y = "PRR", title = paste0("Yearly PRR of adverse event ",gsub("\\+"," ",unique(drug.data$event))," for drug ",unique(drug.data$drug)))+
theme(panel.background=element_rect(fill = "white",colour = "black"),
panel.border=element_rect(colour = "black", fill = NA),
plot.title = element_text(hjust = 0.5, face = "bold",size = 15),
axis.title = element_text(size = 13, face = "bold"),
axis.text = element_text(size = 13, face = "bold"))+
geom_text(label = error.text,size = 4.5, color ="red", y = max(drug.data.temp$PRR) - 0.1, x = mean(drug.data$end.year))
ggplot(data = drug.data.temp , aes(x = end.year , y = PRR))+
geom_line(colour = "purple", size = 2)+
geom_point(colour = "navy", size = 4)+
labs(x="Date", y = "PRR", title = paste0("Yearly PRR of adverse event ",gsub("\\+"," ",unique(drug.data$event))," for drug ",unique(drug.data$drug)))+
theme(panel.background=element_rect(fill = "white",colour = "black"),
panel.border=element_rect(colour = "black", fill = NA),
plot.title = element_text(hjust = 0.5, face = "bold",size = 15),
axis.title = element_text(size = 13, face = "bold"),
axis.text = element_text(size = 13, face = "bold"))+
geom_text(label = error.text,size = 4.5, color ="red", y = max(drug.data.temp$PRR) - 0.1, x = mean(drug.data.temp$end.year))
ggplot(data = drug.data.temp , aes(x = end.year , y = PRR))+
geom_line(colour = "purple", size = 2)+
geom_point(colour = "navy", size = 4)+
labs(x="Date", y = "PRR", title = paste0("Yearly PRR of adverse event ",gsub("\\+"," ",unique(drug.data.temp$event))," for drug ",unique(drug.data$drug)))+
theme(panel.background=element_rect(fill = "white",colour = "black"),
panel.border=element_rect(colour = "black", fill = NA),
plot.title = element_text(hjust = 0.5, face = "bold",size = 15),
axis.title = element_text(size = 13, face = "bold"),
axis.text = element_text(size = 13, face = "bold"))+
geom_text(label = error.text,size = 4.5, color ="red", y = max(drug.data.temp$PRR) - 0.1, x = mean(drug.data.temp$end.year))
ggplot(data = drug.data.temp , aes(x = end.year , y = PRR))+
geom_line(colour = "purple", size = 2)+
geom_point(colour = "navy", size = 4)+
labs(x="Date", y = "PRR", title = paste0("Yearly PRR of adverse event ",gsub("\\+"," ",unique(drug.data.temp$event))," for drug ",unique(drug.data.temp$drug)))+
theme(panel.background=element_rect(fill = "white",colour = "black"),
panel.border=element_rect(colour = "black", fill = NA),
plot.title = element_text(hjust = 0.5, face = "bold",size = 15),
axis.title = element_text(size = 13, face = "bold"),
axis.text = element_text(size = 13, face = "bold"))+
geom_text(label = error.text,size = 4.5, color ="red", y = max(drug.data.temp$PRR) - 0.1, x = mean(drug.data.temp$end.year))
ggplot(data = drug.data.temp , aes(x = end.year , y = PRR))+
geom_line(colour = "purple", size = 2)+
geom_point(colour = "navy", size = 4)+
labs(x="Date", y = "PRR", title = paste0("Yearly PRR of adverse event ",gsub("\\+"," ",unique(drug.data.temp$event))," for drug ",unique(drug.data.temp$drug)))+
theme(panel.background=element_rect(fill = "white",colour = "black"),
panel.border=element_rect(colour = "black", fill = NA),
plot.title = element_text(hjust = 0.5, face = "bold",size = 15),
axis.title = element_text(size = 13, face = "bold"),
axis.text = element_text(size = 13, face = "bold"))+
geom_text(label = error.text,size = 4.5, color ="red", y = max(drug.data.temp$PRR) - 0.1)
ggplot(data = drug.data.temp , aes(x = end.year , y = PRR))+
geom_line(colour = "purple", size = 2)+
geom_point(colour = "navy", size = 4)+
labs(x="Date", y = "PRR",subtitle = error.text ,title = paste0("Yearly PRR of adverse event ",gsub("\\+"," ",unique(drug.data.temp$event))," for drug ",unique(drug.data.temp$drug)))+
theme(panel.background=element_rect(fill = "white",colour = "black"),
panel.border=element_rect(colour = "black", fill = NA),
plot.title = element_text(hjust = 0.5, face = "bold",size = 15),
plot.subtitle = element_text(hjust = 0.5, face = "bold",size = 15, color ="red"),
axis.title = element_text(size = 13, face = "bold"),
axis.text = element_text(size = 13, face = "bold"))
error.text <- "Currently no data is available for companion Dx associated with this drug through openFDA API\nPlease check again at a later time!"
ggplot(data = drug.data.temp , aes(x = end.year , y = PRR))+
geom_line(colour = "purple", size = 2)+
geom_point(colour = "navy", size = 4)+
labs(x="Date", y = "PRR",subtitle = error.text ,title = paste0("Yearly PRR of adverse event ",gsub("\\+"," ",unique(drug.data.temp$event))," for drug ",unique(drug.data.temp$drug)))+
theme(panel.background=element_rect(fill = "white",colour = "black"),
panel.border=element_rect(colour = "black", fill = NA),
plot.title = element_text(hjust = 0.5, face = "bold",size = 15),
plot.subtitle = element_text(hjust = 0.5, face = "bold",size = 15, color ="red"),
axis.title = element_text(size = 13, face = "bold"),
axis.text = element_text(size = 13, face = "bold"))
runApp()
runApp()
runApp()
ggplot(data = drug.data.temp , aes(x = end.year , y = PRR))+
geom_line(colour = "purple", size = 2)+
geom_point(colour = "navy", size = 4)+
labs(x="Date", y = "PRR",subtitle = error.text ,title = paste0("Yearly PRR of adverse event ",gsub("\\+"," ",unique(drug.data.temp$event))," for drug ",unique(drug.data.temp$drug)))+
theme(panel.background=element_rect(fill = "white",colour = "black"),
panel.border=element_rect(colour = "black", fill = NA),
plot.title = element_text(hjust = 0.5, face = "bold",size = 15),
plot.subtitle = element_text(hjust = 0.5, face = "bold",size = 15, color ="red"),
axis.title = element_text(size = 13, face = "bold"),
axis.text = element_text(size = 13, face = "bold"))+
annotate("table", x=1.2, y=1.5, table=d, just=c("left", "top"),
theme=theme.list(show.box = TRUE, separator = "black",
show.csep = TRUE, show.rsep = TRUE, show.colnames=T))
error.text <- "Currently no data is available for a companion Dx associated with this drug through openFDA API\nPlease check again at a later time!"
ggplot(data = drug.data.temp , aes(x = end.year , y = PRR))+
geom_line(colour = "purple", size = 2)+
geom_point(colour = "navy", size = 4)+
labs(x="Date", y = "PRR",subtitle = error.text ,title = paste0("Yearly PRR of adverse event ",gsub("\\+"," ",unique(drug.data.temp$event))," for drug ",unique(drug.data.temp$drug)))+
theme(panel.background=element_rect(fill = "white",colour = "black"),
panel.border=element_rect(colour = "black", fill = NA),
plot.title = element_text(hjust = 0.5, face = "bold",size = 15),
plot.subtitle = element_text(hjust = 0.5, face = "bold",size = 15, color ="red"),
axis.title = element_text(size = 13, face = "bold"),
axis.text = element_text(size = 13, face = "bold"))+
annotate("table", x=1.2, y=1.5, table=d, just=c("left", "top"),
theme=theme.list(show.box = TRUE, separator = "black",
show.csep = TRUE, show.rsep = TRUE, show.colnames=T))
ggplot(data = drug.data.temp , aes(x = end.year , y = PRR))+
geom_line(colour = "purple", size = 2)+
geom_point(colour = "navy", size = 4)+
labs(x="Date", y = "PRR",subtitle = error.text ,title = paste0("Yearly PRR of adverse event ",gsub("\\+"," ",unique(drug.data.temp$event))," for drug ",unique(drug.data.temp$drug)))+
theme(panel.background=element_rect(fill = "white",colour = "black"),
panel.border=element_rect(colour = "black", fill = NA),
plot.title = element_text(hjust = 0.5, face = "bold",size = 15),
plot.subtitle = element_text(hjust = 0.5, face = "bold",size = 15, color ="red"),
axis.title = element_text(size = 13, face = "bold"),
axis.text = element_text(size = 13, face = "bold"))+
annotate("text", x=1.2, y=1.5, table=error.text, just=c("left", "top"),
theme=theme.list(show.box = TRUE, separator = "black",
show.csep = TRUE, show.rsep = TRUE, show.colnames=T))
ggplot(data = drug.data.temp , aes(x = end.year , y = PRR))+
geom_line(colour = "purple", size = 2)+
geom_point(colour = "navy", size = 4)+
labs(x="Date", y = "PRR",subtitle = error.text ,title = paste0("Yearly PRR of adverse event ",gsub("\\+"," ",unique(drug.data.temp$event))," for drug ",unique(drug.data.temp$drug)))+
theme(panel.background=element_rect(fill = "white",colour = "black"),
panel.border=element_rect(colour = "black", fill = NA),
plot.title = element_text(hjust = 0.5, face = "bold",size = 15),
plot.subtitle = element_text(hjust = 0.5, face = "bold",size = 15, color ="red"),
axis.title = element_text(size = 13, face = "bold"),
axis.text = element_text(size = 13, face = "bold"))+
annotate("text", x=1.2, y=1.5, table=error.text, just=c("left", "top"))
ggplot(data = drug.data.temp , aes(x = end.year , y = PRR))+
geom_line(colour = "purple", size = 2)+
geom_point(colour = "navy", size = 4)+
labs(x="Date", y = "PRR",subtitle = error.text ,title = paste0("Yearly PRR of adverse event ",gsub("\\+"," ",unique(drug.data.temp$event))," for drug ",unique(drug.data.temp$drug)))+
theme(panel.background=element_rect(fill = "white",colour = "black"),
panel.border=element_rect(colour = "black", fill = NA),
plot.title = element_text(hjust = 0.5, face = "bold",size = 15),
plot.subtitle = element_text(hjust = 0.5, face = "bold",size = 15, color ="red"),
axis.title = element_text(size = 13, face = "bold"),
axis.text = element_text(size = 13, face = "bold"))+
annotate("text", table=error.text, just=c("left", "top"))
ggplot(data = drug.data.temp , aes(x = end.year , y = PRR))+
geom_line(colour = "purple", size = 2)+
geom_point(colour = "navy", size = 4)+
labs(x="Date", y = "PRR",subtitle = error.text ,title = paste0("Yearly PRR of adverse event ",gsub("\\+"," ",unique(drug.data.temp$event))," for drug ",unique(drug.data.temp$drug)))+
theme(panel.background=element_rect(fill = "white",colour = "black"),
panel.border=element_rect(colour = "black", fill = NA),
plot.title = element_text(hjust = 0.5, face = "bold",size = 15),
plot.subtitle = element_text(hjust = 0.5, face = "bold",size = 15, color ="red"),
axis.title = element_text(size = 13, face = "bold"),
axis.text = element_text(size = 13, face = "bold"))+
annotate("text", text=error.text, just=c("left", "top"))
ggplot(data = drug.data.temp , aes(x = end.year , y = PRR))+
geom_line(colour = "purple", size = 2)+
geom_point(colour = "navy", size = 4)+
labs(x="Date", y = "PRR",subtitle = error.text ,title = paste0("Yearly PRR of adverse event ",gsub("\\+"," ",unique(drug.data.temp$event))," for drug ",unique(drug.data.temp$drug)))+
theme(panel.background=element_rect(fill = "white",colour = "black"),
panel.border=element_rect(colour = "black", fill = NA),
plot.title = element_text(hjust = 0.5, face = "bold",size = 15),
plot.subtitle = element_text(hjust = 0.5, face = "bold",size = 15, color ="red"),
axis.title = element_text(size = 13, face = "bold"),
axis.text = element_text(size = 13, face = "bold"))+
annotate(error.text, just=c("left", "top"))
ggplot(data = drug.data.temp , aes(x = end.year , y = PRR))+
geom_line(colour = "purple", size = 2)+
geom_point(colour = "navy", size = 4)+
labs(x="Date", y = "PRR",subtitle = error.text ,title = paste0("Yearly PRR of adverse event ",gsub("\\+"," ",unique(drug.data.temp$event))," for drug ",unique(drug.data.temp$drug)))+
theme(panel.background=element_rect(fill = "white",colour = "black"),
panel.border=element_rect(colour = "black", fill = NA),
plot.title = element_text(hjust = 0.5, face = "bold",size = 15),
plot.subtitle = element_text(hjust = 0.5, face = "bold",size = 15, color ="red"),
axis.title = element_text(size = 13, face = "bold"),
axis.text = element_text(size = 13, face = "bold"))+
annotate("text", label=error.text, just=c("left", "top"))
ggplot(data = drug.data.temp , aes(x = end.year , y = PRR))+
geom_line(colour = "purple", size = 2)+
geom_point(colour = "navy", size = 4)+
labs(x="Date", y = "PRR" ,title = paste0("Yearly PRR of adverse event ",gsub("\\+"," ",unique(drug.data.temp$event))," for drug ",unique(drug.data.temp$drug)))+
theme(panel.background=element_rect(fill = "white",colour = "black"),
panel.border=element_rect(colour = "black", fill = NA),
plot.title = element_text(hjust = 0.5, face = "bold",size = 15),
plot.subtitle = element_text(hjust = 0.5, face = "bold",size = 15, color ="red"),
axis.title = element_text(size = 13, face = "bold"),
axis.text = element_text(size = 13, face = "bold"))+
annotate("text", label=error.text, just=c("left", "top"))
ggplot(data = drug.data.temp , aes(x = end.year , y = PRR))+
geom_line(colour = "purple", size = 2)+
geom_point(colour = "navy", size = 4)+
labs(x="Date", y = "PRR" ,title = paste0("Yearly PRR of adverse event ",gsub("\\+"," ",unique(drug.data.temp$event))," for drug ",unique(drug.data.temp$drug)))+
theme(panel.background=element_rect(fill = "white",colour = "black"),
panel.border=element_rect(colour = "black", fill = NA),
plot.title = element_text(hjust = 0.5, face = "bold",size = 15),
plot.subtitle = element_text(hjust = 0.5, face = "bold",size = 15, color ="red"),
axis.title = element_text(size = 13, face = "bold"),
axis.text = element_text(size = 13, face = "bold"))+
annotate("text", label=error.text)
p <- ggplot(mtcars, aes(x = wt, y = mpg)) + geom_point()
p + annotate("text", x = 4, y = 25, label = "Some text")
ggplot(data = drug.data.temp , aes(x = end.year , y = PRR))+
geom_line(colour = "purple", size = 2)+
geom_point(colour = "navy", size = 4)+
labs(x="Date", y = "PRR" ,title = paste0("Yearly PRR of adverse event ",gsub("\\+"," ",unique(drug.data.temp$event))," for drug ",unique(drug.data.temp$drug)))+
theme(panel.background=element_rect(fill = "white",colour = "black"),
panel.border=element_rect(colour = "black", fill = NA),
plot.title = element_text(hjust = 0.5, face = "bold",size = 15),
plot.subtitle = element_text(hjust = 0.5, face = "bold",size = 15, color ="red"),
axis.title = element_text(size = 13, face = "bold"),
axis.text = element_text(size = 13, face = "bold"))+
annotate("text", label=error.text , y = max(drug.data.temp$PRR))
ggplot(data = drug.data.temp , aes(x = end.year , y = PRR))+
geom_line(colour = "purple", size = 2)+
geom_point(colour = "navy", size = 4)+
labs(x="Date", y = "PRR" ,title = paste0("Yearly PRR of adverse event ",gsub("\\+"," ",unique(drug.data.temp$event))," for drug ",unique(drug.data.temp$drug)))+
theme(panel.background=element_rect(fill = "white",colour = "black"),
panel.border=element_rect(colour = "black", fill = NA),
plot.title = element_text(hjust = 0.5, face = "bold",size = 15),
plot.subtitle = element_text(hjust = 0.5, face = "bold",size = 15, color ="red"),
axis.title = element_text(size = 13, face = "bold"),
axis.text = element_text(size = 13, face = "bold"))+
annotate("text", label=error.text , y = max(drug.data.temp$PRR), x = drug.data.temp$end.year[2] )
ggplot(data = drug.data.temp , aes(x = end.year , y = PRR))+
geom_line(colour = "purple", size = 2)+
geom_point(colour = "navy", size = 4)+
labs(x="Date", y = "PRR" ,title = paste0("Yearly PRR of adverse event ",gsub("\\+"," ",unique(drug.data.temp$event))," for drug ",unique(drug.data.temp$drug)))+
theme(panel.background=element_rect(fill = "white",colour = "black"),
panel.border=element_rect(colour = "black", fill = NA),
plot.title = element_text(hjust = 0.5, face = "bold",size = 15),
plot.subtitle = element_text(hjust = 0.5, face = "bold",size = 15, color ="red"),
axis.title = element_text(size = 13, face = "bold"),
axis.text = element_text(size = 13, face = "bold"))+
annotate("text", label=error.text , y = max(drug.data.temp$PRR), x = median(drug.data.temp$end.year) )
ggplot(data = drug.data.temp , aes(x = end.year , y = PRR))+
geom_line(colour = "purple", size = 2)+
geom_point(colour = "navy", size = 4)+
labs(x="Date", y = "PRR" ,title = paste0("Yearly PRR of adverse event ",gsub("\\+"," ",unique(drug.data.temp$event))," for drug ",unique(drug.data.temp$drug)))+
theme(panel.background=element_rect(fill = "white",colour = "black"),
panel.border=element_rect(colour = "black", fill = NA),
plot.title = element_text(hjust = 0.5, face = "bold",size = 15),
plot.subtitle = element_text(hjust = 0.5, face = "bold",size = 15, color ="red"),
axis.title = element_text(size = 13, face = "bold"),
axis.text = element_text(size = 13, face = "bold"))+
annotate("text", label=error.text , y = max(drug.data.temp$PRR) - 0.2, x = median(drug.data.temp$end.year), color ="red" )
runApp()
error.text <- "Currently no data is available for a companion Dx associated with this drug through openFDA API\nPlease check again at a later time!"
cat(error.text,"\n")
p <- ggplot(data = drug.data.temp , aes(x = end.year , y = PRR))+
geom_line(colour = "purple", size = 2)+
geom_point(colour = "navy", size = 4)+
labs(x="Date", y = "PRR" ,title = paste0("Yearly PRR of adverse event ",gsub("\\+"," ",unique(drug.data.temp$event))," for drug ",unique(drug.data.temp$drug)))+
theme(panel.background=element_rect(fill = "white",colour = "black"),
panel.border=element_rect(colour = "black", fill = NA),
plot.title = element_text(hjust = 0.5, face = "bold",size = 15),
plot.subtitle = element_text(hjust = 0.5, face = "bold",size = 15, color ="red"),
axis.title = element_text(size = 13, face = "bold"),
axis.text = element_text(size = 13, face = "bold"))+
annotate("text", label=error.text , y = max(drug.data.temp$PRR) - 0.2, x = median(drug.data.temp$end.year), color ="red" )
ggplotly(p)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
y <- fromJSON('https://api.fda.gov/device/event.json?search="PATHVYSION"&count=device.openfda.device_name')
y$results
y <- fromJSON('https://api.fda.gov/device/event.json?search="PATHVYSION"&count=device.openfda.brand_name')
runApp()
# Changing the hover text in ggplotly()
a= "some text"
b= "some more text"
g <- ggplot(df, aes(x,y)) +
geom_point(aes(text=sprintf("letter: %s<br>Letter: %s", a, b)))
(gg <- ggplotly(g))
# Changing the hover text in ggplotly()
a= "some text"
b= "some more text"
g <- ggplot(df, aes(x,y)) +
geom_point(aes(text=sprintf("letter: %s<br>Letter: %s", a, b)))
(gg <- ggplotly(g))
ggplotly(g)
# Changing the hover text in ggplotly()
a= "some text"
b= "some more text"
g <- ggplot(df, aes(x,y)) +
geom_point(aes(text=sprintf("letter: %s<br>Letter: %s", a, b)))
ggplotly(g)
df <- data.frame(x = 5, y = 50)
# Changing the hover text in ggplotly()
a= "some text"
b= "some more text"
g <- ggplot(df, aes(x,y)) +
geom_point(aes(text=sprintf("letter: %s<br>Letter: %s", a, b)))
(gg <- ggplotly(g))
runApp()
runApp()
drug = "Herceptin"
companions <- unique(drug.device.table$Device.Trade.Name[which(drug.device.table$Drug.Trade.Name == tolower(drug))])
device.event.data <- data.frame(device = "",
date_of_event = "",
event_type = "",
event_location ="",
event_description = "")
setwd("~/Desktop/2016/Data_science/companion")
companions <- unique(drug.device.table$Device.Trade.Name[which(drug.device.table$Drug.Trade.Name == tolower(drug))])
device.event.data <- data.frame(device = "",
date_of_event = "",
event_type = "",
event_location ="",
event_description = "")
drug.device.table = readRDS("drug.device.table.rds")
companions <- unique(drug.device.table$Device.Trade.Name[which(drug.device.table$Drug.Trade.Name == tolower(drug))])
device.event.data <- data.frame(device = "",
date_of_event = "",
event_type = "",
event_location ="",
event_description = "")
i =9
companions <- unique(drug.device.table$Device.Trade.Name[which(drug.device.table$Drug.Trade.Name == tolower(drug))])
device.event.data <- data.frame(device = "",
date_of_event = "",
event_type = "",
event_location ="",
event_description = "")
is.this.error <- try(device.event.query <- fromJSON(paste0('https://api.fda.gov/device/event.json?search=device.brand_name:',companions[i],'&limit=100'))$results)
View(device.event.query)
event.text.vector <- sapply((sapply(device.event.query$mdr_text,function(x) return(x$text))),function(x) return(x[1]))
temp <- data.frame(device = companions[i],
date_of_event = device.event.query$date_of_event,
event_type = device.event.query$event_type,
event_location = device.event.query$event_location,
event_description = event.text.vector)
View(temp)
text <- temp$event_description
text <- as.character(temp$event_description)
text
text <- as.character(temp$event_description[1])
text
text <-  unlist(strsplit(text,split = " "))
text1 <- paste(text1, sep = " ")
text1 <- paste(text, sep = " ")
text1 <- paste(text, collapse = " ")
integer(54.4)
round(54.4)
round(length(text)/10)
runApp()
